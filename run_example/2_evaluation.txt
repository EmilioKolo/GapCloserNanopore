
# ChrC telomere: ChrC_C_glabrata_CBS138:1-5000 / ChrC_C_glabrata_CBS138:589500-594600
# Gap in ChrC: ChrC_C_glabrata_CBS138:95600-100700 / ChrC_C_glabrata_CBS138:101600-106700


### Align anchors to contigs

# Extract anchors from reference sequence

python extract_fasta_regions.py \
    --input reference.fasta \
    --region region1 [--region region2] \
    --output-folder output/
    --output-name regions.fasta

# Align anchors to contigs

python align_fastas.py \
    --fasta1 anchors.fasta \
    --fasta2 assembly.fasta \
    --out-prefix output \
    --mafft-threads 4

# Visualize the alignments

python plot_alignments.py \
    --blast-tsv alignment.blast.tsv \
    --mafft-fasta alignment.mafft.fasta \
    --out-prefix alignment_plots \
    --anchor-id-substring ChrC_C_glabrata_CBS138

### Align reads to contig with Minimap2

# Create bam file
minimap2 -ax map-ont \
    reference.fasta reads.fastq | samtools sort -o output.bam

# Index bam file
samtools index output.bam

# Coverage plots (done using CoveragePlotter: https://github.com/EmilioKolo/CoveragePlotter )
python main.py --bam output.bam \
    --fasta reference.fasta \
    --out output.png --binsize 10
